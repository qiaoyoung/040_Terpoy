
#import <Foundation/Foundation.h>

NSString *StringFromLengthAbort_Data(Byte *data);


//: encrypted
Byte screenScanValue[] = {14, 9, 13, 233, 141, 164, 105, 73, 214, 218, 26, 221, 228, 100, 101, 116, 112, 121, 114, 99, 110, 101, 5};

//: fileName
Byte userDirectionResource[] = {84, 8, 7, 144, 222, 53, 101, 101, 109, 97, 78, 101, 108, 105, 102, 79};

//: url
Byte styleEdgeDuringError[] = {50, 3, 12, 57, 82, 168, 215, 168, 91, 130, 51, 113, 108, 114, 117, 150};

//: password
Byte commonMuseResource[] = {56, 8, 13, 26, 104, 54, 206, 231, 173, 77, 94, 112, 146, 100, 114, 111, 119, 115, 115, 97, 112, 60};

//: md5
Byte layoutCycleConfig[] = {38, 3, 3, 53, 100, 109, 89};

//: messageAbstract
Byte userTreasureName[] = {4, 15, 11, 6, 92, 149, 51, 34, 230, 193, 71, 116, 99, 97, 114, 116, 115, 98, 65, 101, 103, 97, 115, 115, 101, 109, 173};

//: sessionId
Byte colorTransmitString[] = {74, 9, 7, 212, 155, 147, 47, 100, 73, 110, 111, 105, 115, 115, 101, 115, 131};

//: message
Byte userSlatePath[] = {29, 7, 3, 101, 103, 97, 115, 115, 101, 109, 168};

//: data
Byte layoutShadeString[] = {80, 4, 3, 97, 116, 97, 100, 203};

//: type
Byte viewYearFormat[] = {29, 4, 7, 86, 80, 150, 235, 101, 112, 121, 116, 192};

//: sender
Byte styleValleyGentleValue[] = {43, 6, 3, 114, 101, 100, 110, 101, 115, 53};

//: compressed
Byte moduleFillPath[] = {49, 10, 6, 23, 240, 222, 100, 101, 115, 115, 101, 114, 112, 109, 111, 99, 5};

//: null
Byte widgetAmongPriorityEvent[] = {94, 4, 8, 47, 37, 57, 100, 195, 108, 108, 117, 110, 5};

//: sessionName
Byte globalPositionInfrastructureName[] = {1, 11, 11, 178, 2, 226, 157, 98, 63, 201, 129, 101, 109, 97, 78, 110, 111, 105, 115, 115, 101, 115, 19};

//: 聊天记录
Byte themeRunKey[] = {61, 12, 12, 102, 57, 79, 123, 126, 200, 222, 70, 86, 149, 189, 229, 176, 174, 232, 169, 164, 229, 138, 129, 232, 206};

// __DEBUG__
// __CLOSE_PRINT__
//
//  ScopeImportStoneGenerate.m
//  NIM
//
//  Created by Netease on 2019/10/16.
//  Copyright © 2019 Netease. All rights reserved.
//

// __M_A_C_R_O__
//: #import "ScopeImportStoneGenerate.h"
#import "ScopeImportStoneGenerate.h"
//: #import "ResponderChipSheet.h"
#import "ResponderChipSheet.h"
//: #import "GlobalCrownArithmeticNative.h"
#import "GlobalCrownArithmeticNative.h"
//: #import "NSDictionary+CompletionIndex.h"
#import "NSDictionary+CompletionIndex.h"
//: #import "DepthConsolidateCreekAutosave+PerformAcknowledgePoolState.h"
#import "DepthConsolidateCreekAutosave+PerformAcknowledgePoolState.h"
//: #import "DescentResilienceTrimEquivalent.h"
#import "DescentResilienceTrimEquivalent.h"
//: #import "TerseRecordNavigateWidescreenShard.h"
#import "TerseRecordNavigateWidescreenShard.h"

//: @interface ScopeImportStoneGenerate ()
@interface ScopeImportStoneGenerate ()

//: @property (nonatomic,strong) DepthConsolidateCreekAutosave *label;
@property (nonatomic,strong) DepthConsolidateCreekAutosave *agile;
//: @property (nonatomic,weak) NIMMessage *message;
@property (nonatomic,weak) NIMMessage *loopAll;

//: @end
@end

//: @implementation ScopeImportStoneGenerate
@implementation ScopeImportStoneGenerate

//: - (NSString *)attachmentPathForUploading {
- (NSString *)attachmentPathForUploading {
    //: return self.filePath;
    return self.protect;
}

//: #pragma mark - 下载相关接口
#pragma mark - 下载相关接口
//: - (BOOL)attachmentNeedsDownload {
- (BOOL)attachmentNeedsDownload {
    //: NSFileManager *fm = [NSFileManager defaultManager];
    NSFileManager *fm = [NSFileManager defaultManager];
    //: BOOL isDir = NO;
    BOOL isDir = NO;
    //: BOOL fileExist = ([fm fileExistsAtPath:self.filePath isDirectory:&isDir]
    BOOL fileExist = ([fm fileExistsAtPath:self.protect isDirectory:&isDir]
                      //: && !isDir);
                      && !isDir);
    //: return !fileExist;
    return !fileExist;
}

//: - (void)setAbstracts:(NSMutableArray<CoreInformationRadiantEarth *> *)abstracts {
- (void)setEvent:(NSMutableArray<CoreInformationRadiantEarth *> *)abstracts {
    //: _abstracts = abstracts;
    _event = abstracts;
    //: NSMutableArray *abstractDics = [NSMutableArray array];
    NSMutableArray *abstractDics = [NSMutableArray array];
    //: for (CoreInformationRadiantEarth *obj in abstracts) {
    for (CoreInformationRadiantEarth *obj in abstracts) {
        //: NSDictionary *objDic = [obj abstractDictionary];
        NSDictionary *objDic = [obj bubbleRealm];
        //: if (objDic) {
        if (objDic) {
            //: [abstractDics addObject:objDic];
            [abstractDics addObject:objDic];
        }
    }
    //: _messageAbstract = abstractDics;
    _agentAgree = abstractDics;
}

//: - (NSString *)encodeAttachment {
- (NSString *)encodeAttachment {

    //: NSMutableDictionary *dataDic = [NSMutableDictionary dictionary];
    NSMutableDictionary *dataDic = [NSMutableDictionary dictionary];
    //: dataDic[@"url"] = _url;
    dataDic[StringFromLengthAbort_Data(styleEdgeDuringError)] = _pick;
    //: dataDic[@"md5"] = _md5;
    dataDic[StringFromLengthAbort_Data(layoutCycleConfig)] = _secondary;
    //: dataDic[@"fileName"] = _fileName;
    dataDic[StringFromLengthAbort_Data(userDirectionResource)] = _work;
    //: dataDic[@"compressed"] = @(_compressed);
    dataDic[StringFromLengthAbort_Data(moduleFillPath)] = @(_blackThorough);
    //: dataDic[@"encrypted"] = @(_encrypted);
    dataDic[StringFromLengthAbort_Data(screenScanValue)] = @(_angle);
    //: dataDic[@"password"] = _password;
    dataDic[StringFromLengthAbort_Data(commonMuseResource)] = _read;
    //: dataDic[@"messageAbstract"] = _messageAbstract;
    dataDic[StringFromLengthAbort_Data(userTreasureName)] = _agentAgree;
    //: dataDic[@"sessionName"] = _sessionName;
    dataDic[StringFromLengthAbort_Data(globalPositionInfrastructureName)] = _merge;
    //: dataDic[@"sessionId"] = _sessionId;
    dataDic[StringFromLengthAbort_Data(colorTransmitString)] = _insideSteam;
    //: NSDictionary *dict = @{@"type" : @(QueueLinkerNavigatorEarthTypeMultiRetweet),
    NSDictionary *dict = @{StringFromLengthAbort_Data(viewYearFormat) : @(QueueLinkerNavigatorEarthTypeMultiRetweet),
                           //: @"data" : dataDic};
                           StringFromLengthAbort_Data(layoutShadeString) : dataDic};
    //: NSData *data = [NSJSONSerialization dataWithJSONObject:dict
    NSData *data = [NSJSONSerialization dataWithJSONObject:dict
                                                   //: options:0
                                                   options:0
                                                     //: error:nil];
                                                     error:nil];
    //: NSString *content = @"";
    NSString *content = @"";
    //: if (data) {
    if (data) {
        //: content = [[NSString alloc] initWithData:data
        content = [[NSString alloc] initWithData:data
                                        //: encoding:NSUTF8StringEncoding];
                                        encoding:NSUTF8StringEncoding];
    }


    //: return content;
    return content;
}

//: - (NSString *)attachmentURLStringForDownloading {
- (NSString *)attachmentURLStringForDownloading {
    //: return _url;
    return _pick;
}

//: - (CGSize)contentSize:(NIMMessage *)message cellWidth:(CGFloat)width {
- (CGSize)bubble:(NIMMessage *)message when:(CGFloat)width {
    //: CGFloat msgBubbleMaxWidth = (width - 130);
    CGFloat msgBubbleMaxWidth = (width - 130);
    //: CGFloat padding = 4.0;
    CGFloat padding = 4.0;
    //: CGFloat msgContentMaxWidth = (msgBubbleMaxWidth - 2 * padding);
    CGFloat msgContentMaxWidth = (msgBubbleMaxWidth - 2 * padding);
    //: NSString *titleString = [self formatTitleMessage];
    NSString *titleString = [self modeUponExtra];
    //: NSDictionary *attribute = @{NSFontAttributeName:[UIFont systemFontOfSize:14]};
    NSDictionary *attribute = @{NSFontAttributeName:[UIFont systemFontOfSize:14]};
    //: CGSize bounding = CGSizeMake(msgContentMaxWidth, 1.7976931348623157e+308);
    CGSize bounding = CGSizeMake(msgContentMaxWidth, 1.7976931348623157e+308);
    //: NSStringDrawingOptions options = NSStringDrawingUsesLineFragmentOrigin |NSStringDrawingUsesFontLeading;
    NSStringDrawingOptions options = NSStringDrawingUsesLineFragmentOrigin |NSStringDrawingUsesFontLeading;
    //: CGSize titleSize = [titleString boundingRectWithSize:bounding
    CGSize titleSize = [titleString boundingRectWithSize:bounding
                                                 //: options:options
                                                 options:options
                                              //: attributes:attribute
                                              attributes:attribute
                                                 //: context:nil].size;
                                                 context:nil].size;

    //: attribute = @{NSFontAttributeName:[UIFont systemFontOfSize:11]};
    attribute = @{NSFontAttributeName:[UIFont systemFontOfSize:11]};
    //: CGSize subTitleSize = [@"聊天记录".user_localized boundingRectWithSize:bounding
    CGSize subTitleSize = [StringFromLengthAbort_Data(themeRunKey).equalByRecording boundingRectWithSize:bounding
                                                               //: options:options
                                                               options:options
                                                            //: attributes:attribute
                                                            attributes:attribute
                                                               //: context:nil].size;
                                                               context:nil].size;


    //: CGFloat abstractHeight = 0;
    CGFloat abstractHeight = 0;
    //: for (CoreInformationRadiantEarth *abs in _abstracts) {
    for (CoreInformationRadiantEarth *abs in _event) {
        //: [self.label nim_setText:[self formatAbstractMessage:abs]];
        [self.agile line:[self duringPreserveAmong:abs]];
        //: CGSize size = [self.label sizeThatFits:CGSizeMake(msgContentMaxWidth, 1.7976931348623157e+308)];
        CGSize size = [self.agile sizeThatFits:CGSizeMake(msgContentMaxWidth, 1.7976931348623157e+308)];
        //: abstractHeight += (size.height + padding);
        abstractHeight += (size.height + padding);
    }

    //: CGFloat height = titleSize.height +
    CGFloat height = titleSize.height +
                    //: abstractHeight + 1.0 +
                    abstractHeight + 1.0 +
                    //: padding + subTitleSize.height;
                    padding + subTitleSize.height;

    //: return CGSizeMake(msgBubbleMaxWidth, height);
    return CGSizeMake(msgBubbleMaxWidth, height);
}

//: - (void)setMessageAbstract:(NSArray *)messageAbstract {
- (void)setAgentAgree:(NSArray *)messageAbstract {
    //: _messageAbstract = messageAbstract;
    _agentAgree = messageAbstract;
    //: if (!messageAbstract) {
    if (!messageAbstract) {
        //: _abstracts = nil;
        _event = nil;
    //: } else {
    } else {
        //: _abstracts = [NSMutableArray array];
        _event = [NSMutableArray array];
        //: for (id obj in messageAbstract) {
        for (id obj in messageAbstract) {
            //: if ([obj isKindOfClass:[NSDictionary class]]) {
            if ([obj isKindOfClass:[NSDictionary class]]) {
                //: CoreInformationRadiantEarth *abstract = [CoreInformationRadiantEarth abstractWithDictionary:obj];
                CoreInformationRadiantEarth *abstract = [CoreInformationRadiantEarth beforeKickWater:obj];
                //: if (abstract) {
                if (abstract) {
                    //: [_abstracts addObject:abstract];
                    [_event addObject:abstract];
                }
            }
        }
    }
}

//: #pragma mark - 上传接口
#pragma mark - 上传接口
//: - (BOOL)attachmentNeedsUpload {
- (BOOL)attachmentNeedsUpload {
    //: return [_url length] == 0;
    return [_pick length] == 0;
}

//: - (BOOL)canBeRevoked {
- (BOOL)selectBefore {
    //: return YES;
    return YES;
}

//: - (NSString *)fileName
- (NSString *)work
{
    //: if (!_fileName) {
    if (!_work) {
        //: _fileName = self.url.lastPathComponent;
        _work = self.pick.lastPathComponent;
    }
    //: return _fileName;
    return _work;
}

//: - (DepthConsolidateCreekAutosave *)label {
- (DepthConsolidateCreekAutosave *)agile {
    //: if (!_label) {
    if (!_agile) {
        //: _label = [[DepthConsolidateCreekAutosave alloc] initWithFrame:CGRectZero];
        _agile = [[DepthConsolidateCreekAutosave alloc] initWithFrame:CGRectZero];
        //: _label.textColor = [UIColor lightGrayColor];
        _agile.textColor = [UIColor lightGrayColor];
        //: _label.font = [UIFont systemFontOfSize:11];
        _agile.font = [UIFont systemFontOfSize:11];
        //: _label.numberOfLines = 1;
        _agile.jet = 1;
    }
    //: return _label;
    return _agile;
}

//: #pragma mark - cell相关
#pragma mark - cell相关
//: - (NSString *)cellContent:(NIMMessage *)message {
- (NSString *)aroundFeature:(NIMMessage *)message {
    //: return @"OverEntropySortDigest";
    return @"OverEntropySortDigest";
}

//: - (NSString *)formatAbstractMessage:(CoreInformationRadiantEarth *)abstract {
- (NSString *)duringPreserveAmong:(CoreInformationRadiantEarth *)abstract {
    //: return [NSString stringWithFormat:@"%@:%@", abstract.sender, abstract.message];
    return [NSString stringWithFormat:@"%@:%@", abstract.deliver, abstract.foot];
}

//: - (NSString *)attachmentPathForDownloading {
- (NSString *)attachmentPathForDownloading {
    //: return self.filePath;
    return self.protect;
}

//: - (UIEdgeInsets)contentViewInsets:(NIMMessage *)message {
- (UIEdgeInsets)ring:(NIMMessage *)message {
    //: return UIEdgeInsetsMake(12.0, 12.0, 12.0, 4.0);
    return UIEdgeInsetsMake(12.0, 12.0, 12.0, 4.0);
}

//: - (void)updateAttachmentURL:(NSString *)urlString {
- (void)updateAttachmentURL:(NSString *)urlString {
    //: self.url = urlString;
    self.pick = urlString;
}

//: - (NSString *)filePath
- (NSString *)protect
{
    //: NSString *filePath = self.fileName ? [ResponderChipSheet filepathForMergeForwardFile:self.fileName] : nil;
    NSString *filePath = self.work ? [ResponderChipSheet tallTo:self.work] : nil;
    //: return filePath;
    return filePath;
}

//: - (BOOL)canBeForwarded {
- (BOOL)man {
    //: return YES;
    return YES;
}

//: - (NSString *)formatTitleMessage {
- (NSString *)modeUponExtra {
    //: return [NSString stringWithFormat:@"%@%@",
    return [NSString stringWithFormat:@"%@%@",
            //: _sessionName,
            _merge,
            //: @"聊天记录".user_localized];
            StringFromLengthAbort_Data(themeRunKey).equalByRecording];
}

//: @end
@end

//: #pragma mark - CoreInformationRadiantEarth
#pragma mark - CoreInformationRadiantEarth


//: @implementation CoreInformationRadiantEarth
@implementation CoreInformationRadiantEarth

//: + (instancetype)abstractWithDictionary:(NSDictionary *)content {
+ (instancetype)beforeKickWater:(NSDictionary *)content {
    //: if (!content) {
    if (!content) {
        //: return nil;
        return nil;
    }
    //: CoreInformationRadiantEarth *ret = [[CoreInformationRadiantEarth alloc] init];
    CoreInformationRadiantEarth *ret = [[CoreInformationRadiantEarth alloc] init];
    //: ret.sender = [content jsonString:@"sender"];
    ret.deliver = [content fitLiberal:StringFromLengthAbort_Data(styleValleyGentleValue)];
    //: ret.message = [content jsonString:@"message"];
    ret.foot = [content fitLiberal:StringFromLengthAbort_Data(userSlatePath)];
    //: return ret;
    return ret;
}

//: + (instancetype)abstractWithMessage:(NIMMessage *)message {
+ (instancetype)advancedCountenseExpand:(NIMMessage *)message {
    //: if (!message) {
    if (!message) {
        //: return nil;
        return nil;
    }
    //: CoreInformationRadiantEarth *ret = [[CoreInformationRadiantEarth alloc] init];
    CoreInformationRadiantEarth *ret = [[CoreInformationRadiantEarth alloc] init];
    //: GlobalCrownArithmeticNative *option = [[GlobalCrownArithmeticNative alloc] init];
    GlobalCrownArithmeticNative *option = [[GlobalCrownArithmeticNative alloc] init];
    //: option.session = message.session;
    option.agent = message.session;
    //: option.message = message;
    option.islandFence = message;
    //: PrioritizeObjectDeployMemberConstrain *info = [[PerformAcknowledgePoolState sharedKit].provider infoByUser:message.from option:option];
    PrioritizeObjectDeployMemberConstrain *info = [[PerformAcknowledgePoolState rock].glad nim:message.from frameDown:option];
    //: ret.sender = info.showName ?: @"null";
    ret.deliver = info.circle ?: StringFromLengthAbort_Data(widgetAmongPriorityEvent);
    //: ret.message = [ret abstract:message];
    ret.foot = [ret pastFade:message];
    //: return ret;
    return ret;
}

//: - (NSDictionary *)abstractDictionary {
- (NSDictionary *)bubbleRealm {
    //: if (_sender && _message) {
    if (_deliver && _foot) {
        //: NSMutableDictionary *dic = [NSMutableDictionary dictionary];
        NSMutableDictionary *dic = [NSMutableDictionary dictionary];
        //: dic[@"sender"] = _sender;
        dic[StringFromLengthAbort_Data(styleValleyGentleValue)] = _deliver;
        //: dic[@"message"] = _message;
        dic[StringFromLengthAbort_Data(userSlatePath)] = _foot;
        //: return dic;
        return dic;
    //: } else {
    } else {
        //: return nil;
        return nil;
    }
}

//: - (NSString *)abstract:(NIMMessage *)message {
- (NSString *)pastFade:(NIMMessage *)message {
    //: NSString *msg = [DescentResilienceTrimEquivalent messageContent:message];
    NSString *msg = [DescentResilienceTrimEquivalent security:message];
    //: NSMutableString *ret = [NSMutableString string];
    NSMutableString *ret = [NSMutableString string];
    //: if (msg.length > (32)) {
    if (msg.length > (32)) {
        //: NSArray *tokens = [[TerseRecordNavigateWidescreenShard currentParser] tokens:msg];
        NSArray *tokens = [[TerseRecordNavigateWidescreenShard noShared] merit:msg];
        //: for (PermutationDelegateStoryboardTribe *token in tokens) { 
        for (PermutationDelegateStoryboardTribe *token in tokens) { //防止emoji表情被截断
            //: if (ret.length > (32)) {
            if (ret.length > (32)) {
                //: break;
                break;
            }
            //: [ret appendString:token.text];
            [ret appendString:token.pure];
        }
    //: } else {
    } else {
        //: [ret appendString:msg];
        [ret appendString:msg];
    }
    //: return ret;
    return ret;
}

//: @end
@end

Byte * LengthAbort_DataToCache(Byte *data) {
    int central = data[0];
    int texture = data[1];
    int belowAlongside = data[2];
    if (!central) return data + belowAlongside;
    for (int i = 0; i < texture / 2; i++) {
        int begin = belowAlongside + i;
        int end = belowAlongside + texture - i - 1;
        Byte temp = data[begin];
        data[begin] = data[end];
        data[end] = temp;
    }
    data[0] = 0;
    data[belowAlongside + texture] = 0;
    return data + belowAlongside;
}

NSString *StringFromLengthAbort_Data(Byte *data) {
    return [NSString stringWithUTF8String:(char *)LengthAbort_DataToCache(data)];
}  
